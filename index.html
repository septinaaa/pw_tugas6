<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Pengambilan Data</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        #user-list {
            margin-top: 20px;
        }
        .user {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin: 5px 0;
            background: #f9f9f9;
            border: 1px solid #ccc;
        }
        .completed {
            text-decoration: line-through;
            color: gray;
        }
    </style>
</head>
<body>
    <h1>Daftar Pengguna</h1>
    <button id="fetch-users">Ambil Data Pengguna</button>
    <input type="text" id="new-user-name" placeholder="Nama Pengguna" required>
    <input type="text" id="new-user-email" placeholder="Email Pengguna" required>
    <button id="add-user">Tambah Pengguna</button>
    <div id="user-list"></div>

    <script>
        document.getElementById('fetch-users').addEventListener('click', fetchUsers);
        document.getElementById('add-user').addEventListener('click', addUser);

        async function fetchUsers() {
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/users');
                if (!response.ok) throw new Error('Gagal mengambil data');
                const users = await response.json();
                displayUsers(users);
            } catch (error) {
                console.error('Error:', error);
                alert(error.message);
            }
        }

        function displayUsers(users) {
            const userList = document.getElementById('user-list');
            userList.innerHTML = '';
            users.forEach(user => {
                const userDiv = document.createElement('div');
                userDiv.className = 'user';
                userDiv.innerHTML = `
                    <span>${user.name} - ${user.username}@example.com</span>
                    <div>
                        <button onclick="markAsCompleted(this)">Selesai</button>
                        <button onclick="deleteUser(this)">Hapus</button>
                    </div>
                `;
                userList.appendChild(userDiv);
            });
        }

        async function addUser() {
            const name = document.getElementById('new-user-name').value.trim();
            const email = document.getElementById('new-user-email').value.trim();
            if (!name || !email) return alert('Semua bidang harus diisi.');

            const newUser = { name, email };

            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/users', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(newUser)
                });
                if (!response.ok) throw new Error('Gagal menambah pengguna');
                const addedUser = await response.json();
                displayUsers([...getCurrentUsers(), addedUser]);
                document.getElementById('new-user-name').value = '';
                document.getElementById('new-user-email').value = '';
            } catch (error) {
                alert(error.message);
            }
        }

        function markAsCompleted(button) {
            const userDiv = button.closest('.user');
            const userName = userDiv.querySelector('span');
            userName.classList.toggle('completed');
        }

        function deleteUser(button) {
            const userDiv = button.closest('.user');
            userDiv.remove();
        }

        function getCurrentUsers() {
            return [...document.getElementsByClassName('user')].map(userDiv => {
                const nameEmail = userDiv.querySelector('span').textContent.split(' - ');
                return {
                    name: nameEmail[0],
                    email: nameEmail[1]
                };
            });
        }
    </script>
</body>
</html>
